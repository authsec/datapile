<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="author" content="Jens Frey" />

        <meta name="description" content="This guide will walk you through installing the PostgreSQL database for use in Apache Roller.
" />
        <meta name="twitter:creator" content="@authsec">
        <meta property="og:type" content="article" />
        <meta name="twitter:card" content="summary">

<meta name="keywords" content="Glassfish, Roller, Backup, Infrastructure, " />

<meta property="og:title" content="Backing up roller weblogger "/>
<meta property="og:url" content="https://datapile.coffeecrew.org/backing-up-roller-weblogger" />
<meta property="og:description" content="This guide will walk you through installing the PostgreSQL database for use in Apache Roller." />
<meta property="og:site_name" content="Datapile" />
<meta property="og:article:author" content="Jens Frey" />
<meta property="og:article:published_time" content="2010-11-01T09:00:34+01:00" />
<meta name="twitter:title" content="Backing up roller weblogger ">
<meta name="twitter:description" content="This guide will walk you through installing the PostgreSQL database for use in Apache Roller.">
<meta property="og:image" content="http://localhost:8000/theme/images/apple-touch-icon-152x152.png" />
<meta name="twitter:image" content="http://localhost:8000/theme/images/apple-touch-icon-152x152.png" >

        <title>Backing up roller weblogger  · Datapile
</title>
        <link href="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/css/bootstrap-combined.min.css" rel="stylesheet">
        <link rel="stylesheet" type="text/css" href="https://datapile.coffeecrew.org/theme/css/elegant.prod.css" media="screen">
        <link rel="stylesheet" type="text/css" href="https://datapile.coffeecrew.org/theme/css/custom.css" media="screen">

        <link rel="shortcut icon" href="https://datapile.coffeecrew.org/theme/images/favicon.ico" type="image/x-icon" />
        <link rel="icon" href="https://datapile.coffeecrew.org/theme/images/apple-touch-icon-152x152.png" type="image/png" />
        <link rel="apple-touch-icon" href="https://datapile.coffeecrew.org/theme/images/apple-touch-icon.png"  type="image/png" />
        <link rel="apple-touch-icon" sizes="57x57" href="https://datapile.coffeecrew.org/theme/images/apple-touch-icon-57x57.png" type="image/png" />
        <link rel="apple-touch-icon" sizes="72x72" href="https://datapile.coffeecrew.org/theme/images/apple-touch-icon-72x72.png" type="image/png" />
        <link rel="apple-touch-icon" sizes="76x76" href="https://datapile.coffeecrew.org/theme/images/apple-touch-icon-76x76.png" type="image/png" />
        <link rel="apple-touch-icon" sizes="114x114" href="https://datapile.coffeecrew.org/theme/images/apple-touch-icon-114x114.png" type="image/png" />
        <link rel="apple-touch-icon" sizes="120x120" href="https://datapile.coffeecrew.org/theme/images/apple-touch-icon-120x120.png" type="image/png" />
        <link rel="apple-touch-icon" sizes="144x144" href="https://datapile.coffeecrew.org/theme/images/apple-touch-icon-144x144.png" type="image/png" />
        <link rel="apple-touch-icon" sizes="152x152" href="https://datapile.coffeecrew.org/theme/images/apple-touch-icon-152x152.png" type="image/png" />
        <link rel="apple-touch-icon" sizes="152x152" href="https://datapile.coffeecrew.org/theme/images/apple-touch-icon-180x180.png" type="image/png" />
        <link href="https://datapile.coffeecrew.org/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Datapile - Full Atom Feed" />
<script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
     (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
     m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
     })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-19717065-1', 'auto');
    ga('send', 'pageview');
</script>


    </head>
    <body>
        <div id="content">
            <div class="navbar navbar-static-top">
                <div class="navbar-inner">
                    <div class="container-fluid">
                        <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                        </a>
                        <a class="brand" href="https://datapile.coffeecrew.org/"><span class=site-name>Datapile</span></a>
                        <div class="nav-collapse collapse">
                            <ul class="nav pull-right top-menu">
                                <li >
                                    <a href=
                                       https://datapile.coffeecrew.org
                                    >Home</a>
                                </li>
                                <li ><a href="https://datapile.coffeecrew.org/categories">Categories</a></li>
                                <li ><a href="https://datapile.coffeecrew.org/tags">Tags</a></li>
                                <li ><a href="https://datapile.coffeecrew.org/archives">Archives</a></li>
                                <li><form class="navbar-search" action="https://datapile.coffeecrew.org/search" onsubmit="return validateForm(this.elements['q'].value);"> <input type="text" class="search-query" placeholder="Search" name="q" id="tipue_search_input"></form></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
            <div class="container-fluid">
                <div class="row-fluid">
                    <div class="span1"></div>
                    <div class="span10">
<article itemscope>
<div class="row-fluid">
    <header class="page-header span10 offset2">
        <h1>
            <a href="https://datapile.coffeecrew.org/backing-up-roller-weblogger">
                Backing up roller&nbsp;weblogger
            </a>
        </h1>
    </header>
</div>

<div class="row-fluid">
        <div class="span8 offset2 article-content">
            
            <p>If you followed the <a class="reference external" href="https://datapile.coffeecrew.org/setup-roller-weblogger-41-on-glassfish-v2">Setup Roller Weblogger 4.1 On Glassfish V2</a> tutorial, or you do have a roller installation already in place, you probably want to back that up&nbsp;somehow.</p>
<div class="section" id="backup-the-file-system">
<h2>Backup the file&nbsp;system</h2>
<p>Since I do not know where you possibly will have installed roller to, I am using the locations from the previous how to. The backup procedure should not be that complex after&nbsp;all.</p>
<p>The data residing on your filesystem (I know, the database resides on the file system too), is the data you uploaded into you blog. You do have a <code>/opt/roller/uploads</code> directory for example. Depending on how many blogs you have created, there are numerous folders inside. Each sub-folder represents data for another blog. So if your blog is called &#8220;datapile&#8221;, then there will be a &#8220;datapile&#8221;&nbsp;sub-folder.</p>
<p>For the sake of simplicity you can of course just backup the whole <code>/opt/roller</code> folder which should also save the custom themes you created eventually. If you installed it the way as described in the tutorial at the beginning, you do also backup search indexes and the glassfish installation with&nbsp;this.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">You might not have deleted the <code>/opt/roller/tmp</code> directory yet. You might backup this temporary files too in this case. If you backup the full <code>/opt/roller</code> directory, you might remove the <code>/opt/roller/tmp</code> folder manually, or at least move it to another location, so your compressed archive will not pack that (unnecessary) information too. A simple command line might look like as&nbsp;follows:</p>
</div>
<div class="highlight"><pre><span></span>$ <span class="nb">cd</span> /opt/ <span class="o">&amp;&amp;</span> tar cjvf /tmp/roller.tar.bz2 roller/
</pre></div>
</div>
<div class="section" id="restore-the-file-system">
<h2>Restore the file&nbsp;system</h2>
<p>In order to restore the file system you have to recreate your installation and then copy the files back to the location where the installation can find them, or simply <code>untar</code> your backed up <code>/opt/roller</code> folder.</p>
</div>
<div class="section" id="backup-the-database">
<h2>Backup the&nbsp;database</h2>
<p>The database can be backed up pretty easily. The part to remember is that you <em>switch to the postgres user</em> when you execute the <code>pg_dumpall &gt; /tmp/rollerDb.dump</code> command.</p>
<p>The backup command order in this case&nbsp;is:</p>
<div class="highlight"><pre><span></span>root@sigusr1:$
        <span class="c1"># su - postgres</span>
        $ pg_dumpall &gt; /tmp/rollerDb.dump
        $ pg_dumpall <span class="p">|</span> bzip2 &gt; /tmp/rollerDb.dump.bz2 <span class="c1">#bzipped version</span>
</pre></div>
</div>
<div class="section" id="restore-the-database">
<h2>Restore the&nbsp;database</h2>
<p>Restoring the full database is a pretty easy task. On a test installation I did, this worked like a charm. I really hope there&#8217;s nothing more to add to&nbsp;it.</p>
<div class="highlight"><pre><span></span>root@sigusr1:$
        <span class="c1"># su - postgres</span>
        $ createdb rollerdb
        $ cat /tmp/rollerDb.dump.bz2 <span class="p">|</span> bunzip2 <span class="p">|</span> psql postgres
        $ psql -f /tmp/rollerDb.dump postgres <span class="c1">#restore from non-compressed file</span>
</pre></div>
<p>After having played back the information into the database, you might need to adopt the postgres passwords back to the values you have set them during your installation on the servlet container (in this case glassfish). You might otherwise end up with some ugly exceptions. To do that start the <code>psql</code> tool as postgres user and enter the following statements (of course adopt to your password ;)&nbsp;).</p>
<div class="highlight"><pre><span></span><span class="n">postgres</span><span class="o">@</span><span class="n">sigusr1</span><span class="p">:</span><span class="o">~</span><span class="err">$</span> <span class="n">psql</span>
<span class="n">postgres</span><span class="o">=#</span> <span class="k">alter</span> <span class="k">user</span> <span class="n">roller</span> <span class="k">with</span> <span class="n">password</span> <span class="s1">&#39;roller&#39;</span><span class="p">;</span>
<span class="n">postgres</span><span class="o">=#</span> <span class="k">alter</span> <span class="k">user</span> <span class="n">postgres</span> <span class="k">with</span> <span class="n">password</span> <span class="s1">&#39;postgres&#39;</span><span class="p">;</span>
</pre></div>
</div>
<div class="section" id="references">
<h2>References</h2>
<p>Especially when it comes to handling the database stuff, the PostgreSQL documentation was very&nbsp;helpful.</p>
<ul class="simple">
<li><a class="reference external" href="http://www.postgresql.org/docs/8.1/static/backup.html">http://www.postgresql.org/docs/8.1/static/backup.html</a></li>
</ul>
</div>



             
 
                <p id="post-share-links">
    Like this post? Share on:
    <a href="https://twitter.com/intent/tweet?text=Backing%20up%20roller%C2%A0weblogger&url=https%3A//datapile.coffeecrew.org/backing-up-roller-weblogger&via=authsec&hashtags=glassfish,roller,backup" target="_blank" rel="nofollow noopener noreferrer" title="Share on Twitter">Twitter</a>
    ❄
    <a href="https://www.facebook.com/sharer/sharer.php?u=https%3A//datapile.coffeecrew.org/backing-up-roller-weblogger" target="_blank" rel="nofollow noopener noreferrer" title="Share on Facebook">Facebook</a>
    ❄
    <a href="mailto:?subject=Backing%20up%20roller%C2%A0weblogger&amp;body=https%3A//datapile.coffeecrew.org/backing-up-roller-weblogger" target="_blank" rel="nofollow noopener noreferrer" title="Share via Email">Email</a>
    </p>

                <hr />
    <div class="author_blurb">
        <a href="https://www.coffeecrew.org/" target="_blank" rel="nofollow noopener noreferrer">
            <img src=https://avatars3.githubusercontent.com/u/7973409?s=400&u=071356b002dc73eed0cf5ff16474df64edd3943c&v=4 alt="Jens Frey Avatar" title="Jens Frey">
            <span class="author_name">Jens Frey</span>
        </a>
        is the creator of the datapile blog.
    </div>

            






            <hr/>
<section>
    <h2>Keep Reading</h2>
<ul class="related-posts-list">
<li><a href="https://datapile.coffeecrew.org/setup-roller-weblogger-41-on-glassfish-v2" title="Setup roller weblogger 4.1 on Glassfish v2">Setup roller weblogger 4.1 on Glassfish v2</a></li>
<li><a href="https://datapile.coffeecrew.org/switching-roller-from-derby-to-postgresql" title="Switching roller from Derby to PostgreSQL">Switching roller from Derby to PostgreSQL</a></li>
<li><a href="https://datapile.coffeecrew.org/roller-template" title="Roller template">Roller template</a></li>
<li><a href="https://datapile.coffeecrew.org/back-to-qnap" title="Back To QNAP">Back To QNAP</a></li>
</ul>
<hr />
</section>
            <aside>
            <nav>
            <ul class="articles-timeline">
                <li class="previous-article">« <a href="https://datapile.coffeecrew.org/switching-roller-from-derby-to-postgresql" title="Previous: Switching roller from Derby to PostgreSQL">Switching roller from Derby to PostgreSQL</a></li>
                <li class="next-article"><a href="https://datapile.coffeecrew.org/programming-with-the-apr" title="Next: Programming with the APR">Programming with the APR</a> »</li>
            </ul>
            </nav>
            </aside>
        </div>
        <section id="article-sidebar" class="span2">
            <h4>Published</h4>
            <time itemprop="dateCreated" datetime="2010-11-01T09:00:34+01:00">Nov 1, 2010</time>
            <h4>Category</h4>
            <a class="category-link" href="https://datapile.coffeecrew.org/categories#infrastructure-ref">Infrastructure</a>
            <h4>Tags</h4>
            <ul class="list-of-tags tags-in-article">
                <li><a href="https://datapile.coffeecrew.org/tags#backup-ref">Backup
                    <span>2</span>
</a></li>
                <li><a href="https://datapile.coffeecrew.org/tags#glassfish-ref">Glassfish
                    <span>3</span>
</a></li>
                <li><a href="https://datapile.coffeecrew.org/tags#roller-ref">Roller
                    <span>4</span>
</a></li>
            </ul>
<h4>Stay in Touch</h4>
<div id="sidebar-social-link">
    <a href="https://github.com/authsec/" title="Authsec Github Repository" target="_blank" rel="nofollow noopener noreferrer">
        <svg xmlns="http://www.w3.org/2000/svg" aria-label="GitHub" role="img" viewBox="0 0 512 512"><rect width="512" height="512" rx="15%" fill="#1B1817"/><path fill="#fff" d="M335 499c14 0 12 17 12 17H165s-2-17 12-17c13 0 16-6 16-12l-1-50c-71 16-86-28-86-28-12-30-28-37-28-37-24-16 1-16 1-16 26 2 40 26 40 26 22 39 59 28 74 22 2-17 9-28 16-35-57-6-116-28-116-126 0-28 10-51 26-69-3-6-11-32 3-67 0 0 21-7 70 26 42-12 86-12 128 0 49-33 70-26 70-26 14 35 6 61 3 67 16 18 26 41 26 69 0 98-60 120-117 126 10 8 18 24 18 48l-1 70c0 6 3 12 16 12z"/></svg>
    </a>
    <a href="https://twitter.com/authsec" title="" target="_blank" rel="nofollow noopener noreferrer">
        <svg xmlns="http://www.w3.org/2000/svg" aria-label="Twitter" role="img" viewBox="0 0 512 512"><rect width="512" height="512" rx="15%" fill="#1da1f3"/><path fill="#fff" d="M437 152a72 72 0 0 1-40 12 72 72 0 0 0 32-40 72 72 0 0 1-45 17 72 72 0 0 0-122 65 200 200 0 0 1-145-74 72 72 0 0 0 22 94 72 72 0 0 1-32-7 72 72 0 0 0 56 69 72 72 0 0 1-32 1 72 72 0 0 0 67 50 200 200 0 0 1-105 29 200 200 0 0 0 309-179 200 200 0 0 0 35-37"/></svg>
    </a>
    <a href="https://www.linkedin.com/in/jens-frey-409ab844/" title="" target="_blank" rel="nofollow noopener noreferrer">
        <svg xmlns="http://www.w3.org/2000/svg" aria-label="LinkedIn" role="img" viewBox="0 0 512 512" fill="#fff"><rect width="512" height="512" rx="15%" fill="#0077b5"/><circle cx="142" cy="138" r="37"/><path stroke="#fff" stroke-width="66" d="M244 194v198M142 194v198"/><path d="M276 282c0-20 13-40 36-40 24 0 33 18 33 45v105h66V279c0-61-32-89-76-89-34 0-51 19-59 32"/></svg>
    </a>
    <a href="https://www.youtube.com/jensfrey" title="" target="_blank" rel="nofollow noopener noreferrer">
        <svg xmlns="http://www.w3.org/2000/svg" aria-label="YouTube" role="img" viewBox="0 0 512 512" fill="#ed1d24"><rect width="512" height="512" rx="15%"/><path d="m427 169c-4-15-17-27-32-31-34-9-239-10-278 0-15 4-28 16-32 31-9 38-10 135 0 174 4 15 17 27 32 31 36 10 241 10 278 0 15-4 28-16 32-31 9-36 9-137 0-174" fill="#fff"/><path d="m220 203v106l93-53"/></svg>
    </a>
    <a href="http://localhost:8000/feeds/all.atom.xml" title="" target="_blank" rel="nofollow noopener noreferrer">
        <svg xmlns="http://www.w3.org/2000/svg" aria-label="RSS" role="img" viewBox="0 0 512 512"><rect width="512" height="512" rx="15%" fill="#f80"/><circle cx="145" cy="367" r="35" fill="#fff"/><path fill="none" stroke="#fff" stroke-width="60" d="M109 241c89 0 162 73 162 162M109 127c152 0 276 124 276 276"/></svg>
    </a>
</div>
            





            





        </section>
</div>
</article>
                    </div>
                    <div class="span1"></div>
                </div>
            </div>
        </div>
<footer>
    <div>
        Content licensed under <a rel="license nofollow noopener noreferrer"
    href="http://creativecommons.org/licenses/by/4.0/" target="_blank">
    Creative Commons Attribution 4.0 International License</a>.
    </div>

    <div>
        <span class="site-name">Datapile</span> - Against Digital Amnesia
    </div>



    <div id="fpowered">
        Powered by: <a href="http://getpelican.com/" title="Pelican Home Page" target="_blank" rel="nofollow noopener noreferrer">Pelican</a>
        Theme: <a href="https://elegant.oncrashreboot.com/" title="Theme Elegant Home Page" target="_blank" rel="nofollow noopener noreferrer">Elegant</a>
        Hosted on:
        <a href=https://datapile.coffeecrew.org/ target="_blank" rel="nofollow noopener noreferrer">
            Github
        </a>
    </div>
</footer>            <script src="//code.jquery.com/jquery.min.js"></script>
        <script src="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/js/bootstrap.min.js"></script>
        <script>
            function validateForm(query)
            {
                return (query.length > 0);
            }
        </script>

    <script>
    (function () {
        if (window.location.hash.match(/^#comment-\d+$/)) {
            $('#comment_thread').collapse('show');
        }
    })();
    window.onhashchange=function(){
        if (window.location.hash.match(/^#comment-\d+$/))
            window.location.reload(true);
    }
    $('#comment_thread').on('shown', function () {
        var link = document.getElementById('comment-accordion-toggle');
        var old_innerHTML = link.innerHTML;
        $(link).fadeOut(200, function() {
            $(this).text('Click here to hide comments').fadeIn(200);
        });
        $('#comment_thread').on('hidden', function () {
            $(link).fadeOut(200, function() {
                $(this).text(old_innerHTML).fadeIn(200);
            });
        })
    })
</script>

    </body>
    <!-- Theme: Elegant built for Pelican
        License : MIT -->
</html>