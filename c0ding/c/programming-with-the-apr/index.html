<!doctype html>
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin SEO -->









<title>Programming with the APR - The Datapile</title>




<meta name="description" content="This article will give you an introduction of how to program with theApache Portable Runtime (APR). It illustrates a simple command lineprogram.">




<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="The Datapile">
<meta property="og:title" content="Programming with the APR">


  <link rel="canonical" href="https://datapile.coffeecrew.org/c0ding/c/programming-with-the-apr/">
  <meta property="og:url" content="https://datapile.coffeecrew.org/c0ding/c/programming-with-the-apr/">



  <meta property="og:description" content="This article will give you an introduction of how to program with theApache Portable Runtime (APR). It illustrates a simple command lineprogram.">



  <meta name="twitter:site" content="@authsec">
  <meta name="twitter:title" content="Programming with the APR">
  <meta name="twitter:description" content="This article will give you an introduction of how to program with theApache Portable Runtime (APR). It illustrates a simple command lineprogram.">
  <meta name="twitter:url" content="https://datapile.coffeecrew.org/c0ding/c/programming-with-the-apr/">

  
    <meta name="twitter:card" content="summary">
    
  

  



  

  





  <meta property="og:type" content="article">
  <meta property="article:published_time" content="2010-11-01T10:00:34+01:00">








  <script type="application/ld+json">
    {
      "@context" : "http://schema.org",
      "@type" : "Person",
      "name" : "Jens Frey",
      "url" : "https://datapile.coffeecrew.org",
      "sameAs" : null
    }
  </script>






<!-- end SEO -->


<link href="https://datapile.coffeecrew.org/feed.xml" type="application/atom+xml" rel="alternate" title="The Datapile Feed">

<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="https://datapile.coffeecrew.org/assets/css/main.css">

<meta http-equiv="cleartype" content="on">
    <!-- start custom head snippets -->

<!-- insert favicons. use http://realfavicongenerator.net/ -->

<!-- end custom head snippets -->
  </head>

  <body class="layout--single">

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->
    <div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        <button><div class="navicon"></div></button>
        <ul class="visible-links">
          <li class="masthead__menu-item masthead__menu-item--lg"><a href="https://datapile.coffeecrew.org/">The Datapile</a></li>
          
            
            <li class="masthead__menu-item"><a href="https://datapile.coffeecrew.org/year-archive/">Archive</a></li>
          
            
            <li class="masthead__menu-item"><a href="https://mmistakes.github.io/minimal-mistakes/">About</a></li>
          
            
            <li class="masthead__menu-item"><a href="https://datapile.coffeecrew.org/categories/">Categories archive</a></li>
          
            
            <li class="masthead__menu-item"><a href="https://datapile.coffeecrew.org/tags/">Tags</a></li>
          
        </ul>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>

    


  
    



<nav class="breadcrumbs">
  <ol itemscope itemtype="http://schema.org/BreadcrumbList">
    
    
    
      
        <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
          <a href="https://datapile.coffeecrew.org/" itemprop="item"><span itemprop="name">Home</span></a>
          <meta itemprop="position" content="1" />
        </li>
        <span class="sep">/</span>
      
      
        
        <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
          <a href="https://datapile.coffeecrew.org/c0ding" itemprop="item"><span itemprop="name">C0ding</span></a>
          <meta itemprop="position" content="2" />
        </li>
        <span class="sep">/</span>
      
    
      
      
        
        <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
          <a href="https://datapile.coffeecrew.org/c" itemprop="item"><span itemprop="name">C</span></a>
          <meta itemprop="position" content="3" />
        </li>
        <span class="sep">/</span>
      
    
      
      
        <li class="current">Programming with the APR</li>
      
    
  </ol>
</nav>
  


<div id="main" role="main">
  


  <div class="sidebar sticky">
  

<div itemscope itemtype="http://schema.org/Person">

  
    <div class="author__avatar">
      
        <img src="https://datapile.coffeecrew.org/images/me.png" class="author__avatar" alt="" itemprop="image">
      
    </div>
  

  <div class="author__content">
    <h3 class="author__name" itemprop="name"></h3>
    
      <p class="author__bio" itemprop="description">
        Developer. Musician.
      </p>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      
        <li itemprop="homeLocation" itemscope itemtype="http://schema.org/Place">
          <i class="fa fa-fw fa-map-marker" aria-hidden="true"></i> <span itemprop="name">Lörrach</span>
        </li>
      

      

      

      

      
        <li>
          <a href="https://twitter.com/authsec" itemprop="sameAs">
            <i class="fa fa-fw fa-twitter-square" aria-hidden="true"></i> Twitter
          </a>
        </li>
      

      

      
        <li>
          <a href="https://plus.google.com/+JensFrey" itemprop="sameAs">
            <i class="fa fa-fw fa-google-plus-square" aria-hidden="true"></i> Google+
          </a>
        </li>
      

      

      

      

      

      

      
        <li>
          <a href="https://github.com/authsec" itemprop="sameAs">
            <i class="fa fa-fw fa-github" aria-hidden="true"></i> GitHub
          </a>
        </li>
      

      

      

      

      

      

      

      
        <li>
          <a href="https://www.youtube.com/user/../c/JensFrey" itemprop="sameAs">
            <i class="fa fa-fw fa-youtube-square" aria-hidden="true"></i> YouTube
          </a>
        </li>
      

      
        <li>
          <a href="https://soundcloud.com/john-c-flow" itemprop="sameAs">
            <i class="fa fa-fw fa-soundcloud" aria-hidden="true"></i> Soundcloud
          </a>
        </li>
      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs">
      <i class="fa fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>
</div>

  
  
  </div>



  <article class="page" itemscope itemtype="http://schema.org/CreativeWork">
    <meta itemprop="headline" content="Programming with the APR">
    <meta itemprop="description" content="This article will give you an introduction of how to program with theApache Portable Runtime (APR). It illustrates a simple command lineprogram.">
    <meta itemprop="datePublished" content="November 01, 2010">
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 class="page__title" itemprop="headline">Programming with the APR
</h1>
          
            <p class="page__meta"><i class="fa fa-clock-o" aria-hidden="true"></i> 




  2 minute read
</p>
          
        </header>
      

      <section class="page__content" itemprop="text">
        <p>This article will give you an introduction of how to program with the
Apache Portable Runtime (APR). It illustrates a simple command line
program.</p>

<p><strong>NOTE:</strong> The program supplied should actually use
  <code class="highlighter-rouge">apr_app_initialize(&amp;argc, &amp;argv, NULL);</code> since <code class="highlighter-rouge">apr_initialize()</code>
  is intended for library use only.</p>

<p>I was playing around with the Apache Portable Runtime (APR) recently
and found out, probably the most difficult part was to find out how to
compile the program you have just written. The probably most famous
projects using APR are the Apache HTTPd and Subversion.</p>

<h2 id="overview">Overview</h2>

<p>APR’s goal is to provide a platform independent API that provides a
consistent interface to the platform specific implementation. The APR
code itself is pretty good documented. But i wouldn’t say you’d find
plenty of resources on the web. Especially a simple example on how to
program with the APR was missing for me.</p>

<h2 id="example-program">Example program</h2>

<p>I put together an example program which shows how to use the APR. This
includes instructions on how to get the program compiled after you
have written it. This seems to be so self-evident to people, that no
one seems to write that up. The heart of this process lies in the
usage of the <code class="highlighter-rouge">apr-config</code>, or sometimes called <code class="highlighter-rouge">apr-1-config</code> utility.</p>

<h3 id="preconditions">Preconditions</h3>

<p>Make sure you have the APR development files installed. Since i am
mostly working with Debian based distributions, like Debian itself or
Ubuntu, i install the libraries with my package management system. Of
course make sure you install the “-dev” versions of APR. For me
that have been the packages</p>

<ul>
  <li>libapr1</li>
  <li>libapr1-dbg</li>
  <li>libapr1-dev</li>
  <li>libaprutil1</li>
  <li>libaprutil1-dbg</li>
  <li>libaprutil1-dev</li>
</ul>

<p>You can get those packages by issuing the following command on the
command line (this may of course vary if you are not using a Debian
based distribution or if you install from source).</p>

<p>``` bash Install APR Development Libraries
$ sudo apt-get install libapr1 libapr1-dbg libapr1-dev libaprutil1 libaprutil1-dbg libaprutil1-dev</p>
<div class="highlighter-rouge"><pre class="highlight"><code>
### Program code

The program itself is obviously a pretty easy one, it basically
allocates resources from a memory pool managed through APR onto a
struct and later simply prints the allocated values. The programs code
is as follows.



### Compile the program

Now there comes the next crucial step in getting your program to
fly. To do so you probably best export a variable as suggested by the
`apr-1-config` tool. Then you can go on an compile your program the
"normal" way you'd do that. If you do not want debug symbols
compiled into your code, you of course would remove the "-g"
option in front of the APR_LIBS variable.

``` bash Simple APR Program Compilation
$&gt; export APR_LIBS="`apr-1-config --cflags --cppflags --includes --ldflags --link-ld --libs`"
$&gt; gcc -g simple_apr.c -o simple_apr $APR_LIBS
</code></pre>
</div>

<p>By executing the program your output should now look something like that:</p>

<p><code class="highlighter-rouge">bash Ouput
$ ./simple_apr
Username: Jens Frey
Password: secret
Time: 1231102877630911
Time readable: Sun, 04 Jan 2009 21:01:17 GMT
</code></p>

<p>I hope you achieved similar results.</p>

<h2 id="references">References</h2>

<ul>
  <li><a href="http://apr.apache.org/">The APR homepage</a></li>
  <li><a href="http://apr.apache.org/docs/apr/trunk/">The APR API documentation</a></li>
  <li><a href="http://svn.apache.org/viewvc/apr/apr/trunk/docs/pool-design.html?view=co">Using APR pools</a></li>
  <li><a href="http://people.apache.org/~rooneg/talks/portable-c-with-apr/apr.html">Writing Portable C Code with APR</a></li>
</ul>


        
      </section>

      <footer class="page__meta">
        
        


        
          <p class="page__date"><strong><i class="fa fa-fw fa-calendar" aria-hidden="true"></i> Updated:</strong> <time datetime="2010-11-01T10:00:34+01:00">November 01, 2010</time></p>
        
      </footer>

      <section class="page__share">
  
    <h4 class="page__share-title">Share on</h4>
  

  <a href="https://twitter.com/intent/tweet?via=authsec&text=Programming with the APR https://datapile.coffeecrew.org/c0ding/c/programming-with-the-apr/" class="btn btn--twitter" title="Share on Twitter"><i class="fa fa-fw fa-twitter" aria-hidden="true"></i><span> Twitter</span></a>

  <a href="https://www.facebook.com/sharer/sharer.php?u=https://datapile.coffeecrew.org/c0ding/c/programming-with-the-apr/" class="btn btn--facebook" title="Share on Facebook"><i class="fa fa-fw fa-facebook" aria-hidden="true"></i><span> Facebook</span></a>

  <a href="https://plus.google.com/share?url=https://datapile.coffeecrew.org/c0ding/c/programming-with-the-apr/" class="btn btn--google-plus" title="Share on Google Plus"><i class="fa fa-fw fa-google-plus" aria-hidden="true"></i><span> Google+</span></a>

  <a href="https://www.linkedin.com/shareArticle?mini=true&url=https://datapile.coffeecrew.org/c0ding/c/programming-with-the-apr/" class="btn btn--linkedin" title="Share on LinkedIn"><i class="fa fa-fw fa-linkedin" aria-hidden="true"></i><span> LinkedIn</span></a>
</section>


      
  <nav class="pagination">
    
      <a href="https://datapile.coffeecrew.org/backing-up-roller-weblogger/" class="pagination--pager" title="Backing up roller weblogger
">Previous</a>
    
    
      <a href="https://datapile.coffeecrew.org/c0ding/c/programming-with-the-apr-persisting-information/" class="pagination--pager" title="Programming with the APR - Persisting information
">Next</a>
    
  </nav>

    </div>

    
  </article>

  
  
</div>

    <div class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    
      <li><strong>Follow:</strong></li>
    
    
      <li><a href="https://twitter.com/authsec"><i class="fa fa-fw fa-twitter-square" aria-hidden="true"></i> Twitter</a></li>
    
    
    
      <li><a href="http://github.com/authsec"><i class="fa fa-fw fa-github" aria-hidden="true"></i> GitHub</a></li>
    
    
    <li><a href="https://datapile.coffeecrew.org/feed.xml"><i class="fa fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2018 Jens Frey. Powered by <a href="http://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>
      </footer>
    </div>

    <script src="https://datapile.coffeecrew.org/assets/js/main.min.js"></script>




  <script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-19717065-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>






  </body>
</html>
